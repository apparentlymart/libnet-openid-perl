<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>draft: OpenID DTP Version 1.0 Adjuncts - Draft 02</title>
<meta http-equiv="Expires" content="Wed, 09 Aug 2006 18:28:14 +0000">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="OpenID DTP Version 1.0 Adjuncts - Draft 02">
<meta name="generator" content="xml2rfc v1.30 (http://xml.resource.org/)">
<style type='text/css'>
<!--
    body {
        font-family: verdana, charcoal, helvetica, arial, sans-serif;
        margin: 2em;
        font-size: small ; color: #000000 ; background-color: #ffffff ; }
    .title { color: #990000; font-size: x-large ;
        font-weight: bold; text-align: right;
        font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
        background-color: transparent; }
    .filename { color: #666666; font-size: 18px; line-height: 28px;
        font-weight: bold; text-align: right;
        font-family: helvetica, arial, sans-serif;
        background-color: transparent; }
    td.rfcbug { background-color: #000000 ; width: 30px ; height: 30px ;
        text-align: justify; vertical-align: middle ; padding-top: 2px ; }
    td.rfcbug span.RFC { color: #666666; font-weight: bold; text-decoration: none;
        background-color: #000000 ;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; }
    td.rfcbug span.hotText { color: #ffffff; font-weight: normal; text-decoration: none;
        text-align: center ;
        font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; background-color: #000000; }
    /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
    div#counter{margin-top: 100px}

    a.info{
        position:relative; /*this is the key*/
        z-index:24;
        text-decoration:none}

    a.info:hover{z-index:25; background-color:#990000 ; color: #ffffff ;}

    a.info span{display: none}

    a.info:hover span.info{ /*the span will display just on :hover state*/
        display:block;
        position:absolute;
        font-size: smaller ;
        top:2em; left:2em; width:15em;
        padding: 2px ;
        border:1px solid #333333;
        background-color:#eeeeee; color:#990000;
        text-align: left ;}

     A { font-weight: bold; }
     A:link { color: #990000; background-color: transparent ; }
     A:visited { color: #333333; background-color: transparent ; }
     A:active { color: #333333; background-color: transparent ; }

    p { margin-left: 2em; margin-right: 2em; }
    p.copyright { font-size: x-small ; }
    p.toc { font-size: small ; font-weight: bold ; margin-left: 3em ;}
    table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
    td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

    span.emph { font-style: italic; }
    span.strong { font-weight: bold; }
    span.verb, span.vbare { font-family: "Courier New", Courier, monospace ; }

    span.vemph { font-style: italic; font-family: "Courier New", Courier, monospace ; }
    span.vstrong { font-weight: bold; font-family: "Courier New", Courier, monospace ; }
    span.vdeluxe { font-weight: bold; font-style: italic; font-family: "Courier New", Courier, monospace ; }

    ol.text { margin-left: 2em; margin-right: 2em; }
    ul.text { margin-left: 2em; margin-right: 2em; }
    li { margin-left: 3em;  }

    pre { margin-left: 3em; color: #333333;  background-color: transparent;
        font-family: "Courier New", Courier, monospace ; font-size: small ;
        text-align: left;
        }

    h3 { color: #333333; font-size: medium ;
        font-family: helvetica, arial, sans-serif ;
        background-color: transparent; }
    h4 { font-size: small; font-family: helvetica, arial, sans-serif ; }

    table.bug { width: 30px ; height: 15px ; }
    td.bug { color: #ffffff ; background-color: #990000 ;
        text-align: center ; width: 30px ; height: 15px ;
         }
    td.bug A.link2 { color: #ffffff ; font-weight: bold;
        text-decoration: none;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
        font-size: x-small ; background-color: transparent }

    td.header { color: #ffffff; font-size: x-small ;
        font-family: arial, helvetica, sans-serif; vertical-align: top;
        background-color: #666666 ; width: 33% ; }
    td.author { font-weight: bold; margin-left: 4em; font-size: x-small ; }
    td.author-text { font-size: x-small; }
    table.full { vertical-align: top ; border-collapse: collapse ;
        border-style: solid solid solid solid ;
        border-color: black black black black ;
        font-size: small ; text-align: center ; }
    table.headers, table.none { vertical-align: top ; border-collapse: collapse ;
        border-style: none;
        font-size: small ; text-align: center ; }
    table.full th { font-weight: bold ;
        border-style: solid ;
        border-color: black black black black ; }
    table.headers th { font-weight: bold ;
        border-style: none none solid none;
        border-color: black black black black ; }
    table.none th { font-weight: bold ;
        border-style: none; }
    table.full td {
        border-style: solid solid solid solid ;
        border-color: #333333 #333333 #333333 #333333 ; }
    table.headers td, table.none td { border-style: none; }

    hr { height: 1px }
-->
</style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">draft</td><td class="header">G. Monroe</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">JanRain</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 9, 2006</td></tr>
</table></td></tr></table>
<div align="right"><span class="title"><br />OpenID DTP Version 1.0 Adjuncts - Draft 02</span></div>

<h3>Abstract</h3>

<p>
        OpenID DTP is a protocol for sending, receiving, and relaying an
        arbitrary signed and encrypted payload between two
        endpoints. DTP Version 1.0 Part 2: Adjuncts defines a set of
        adjuncts that may be used with DTP Version 1.0 Part 1:
        Envelopes. This specification depends
        on the messages described in Part 1.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Additional Terminology<br />
<a href="#discovery">2.</a>&nbsp;
Discovery<br />
<a href="#extension_algorithms">3.</a>&nbsp;
Extension Algorithms<br />
<a href="#anchor2">4.</a>&nbsp;
HTTP(S) Binding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.1.</a>&nbsp;
HTTP Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.2.</a>&nbsp;
HTTP Response<br />
<a href="#rfc.references1">5.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;Additional Terminology</h3>

<p>
        </p>
<blockquote class="text"><dl>
<dt>Reciever Endpoint URL:</dt>
<dd>
            The HTTP URL that accepts incoming messages for a User.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="discovery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;Discovery</h3>

<p>
        User public keys and Reciever Endpoint URLs are discovered using Yadis
        or XRI Resolution. If the Identifier is a URL, the Yadis
        protocol MUST be attempted on that URL. The Yadis protocol and
        XRI resolution both yield an XRDS document. This is a simple XML document with entries for services that
        are related to the Identifier. Each <span class="verb">&lt;xrd:Service&gt;</span> element in the XRD that
        provides messaging will contain the following information:

        </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
            An <span class="verb">&lt;xrd:Type&gt;</span> element
            whose inner text is "http://www.example.com/2006/06/dtp#"
          
</dd>
<dt></dt>
<dd>
            An <span class="verb">&lt;xrd:URI&gt;</span> tag whose
            text content is the Reciever Endpoint URL
          
</dd>
<dt></dt>
<dd>
            A <span class="verb">&lt;PublicKey&gt;</span> element
            whose text content is the URL of the Public Key for that
            Reciever Endpoint URL.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        Once the appropriate Service has been discovered, the
        Public Key for that Reciever Endpoint URL can be retrieved by
        performing an HTTP GET using URL contained in the
        <span class="verb">&lt;PublicKey&gt;</span> element.
      
</p>
<p>
        Currently only one form of public key is defined. The HTTP
        response should be a PEM formatted RSA Public Key and have a
        Content-Type of "application/pem".
      
</p>
<a name="extension_algorithms"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;Extension Algorithms</h3>

<p>
        If a Reciever Endpoint supports alternative cryptographic
        algorithms, they can be advertised in the <span class="verb">&lt;xrd:Service&gt;</span> element of the XRDS
        document containing the Reciever Endpoint URL by adding an
        additional <span class="verb">&lt;xrd:Type&gt;</span>
        element containing the algorithm identifier.
      
</p>
<p>
        When a sender parses the XRDS document during <a class="info" href="#discovery">discovery<span> (</span><span class="info">Discovery</span><span>)</span></a>, they can then look for
        advertised extension algorithms that they know about. It is up
        to the sender what algorithm is used. Advertising extenstion
        algorithms is purely advisory, and senders are in no way
        obligated to use them. It is an error to use an extension
        algorithm that is not advertised.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;HTTP(S) Binding</h3>

<p>
        This section describes a mechanism for sending and recieving
        messages using the Hypertext Transport Protocol 1.1 <a class="info" href="#HTTP">[HTTP]<span> (</span><span class="info">Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; .</span><span>)</span></a>. If a Reciever Endpoint URL has an HTTPS
        scheme, it may be reasonable to use the NULL encryption type,
        depending on the application.
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;HTTP Request</h3>

<p>
          A request to send a message to a Reciever Endpoint URL is an
          HTTP request with the Method set to POST. The body the
          request is the Outer Envelope XML document. The Content-Type
          header of the request should be set to
          "application/dtp+xml".
        
</p>
<p>
          The Reciever Endpoint should verify the message according to
          the rules described in the Message Validation section of
          <a class="info" href="#DTP-1">[DTP-1]<span> (</span><span class="info">Monroe, G., &ldquo;DTP Version 1.0 Part 1: Envelopes,&rdquo; .</span><span>)</span></a> as well as any application-specific
          verification that is necessary before returning a response.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;HTTP Response</h3>

<p>
          The HTTP Response Entity will either be emtpy, denoted by a
          Content-Length Header of 0, or an Outer Envelope XML
          Document. If the response entity exists, it should be
          accompanied by a Content-Type header of
          "application/dtp+xml".
        
</p>
<p>
           It is up to the application whether a response entity is
           appropriate. A response entity is only appropriate with an
           HTTP Status Code of 200.
        
</p>
<p>
          HTTP Status Codes should be interpreted as follows:
          </p>
<blockquote class="text"><dl>
<dt>200</dt>
<dd>
              The message was delivered successfully; no further
              action is required of the client.
            
</dd>
<dt>400</dt>
<dd>
              Processing the message resulted in an error code. The
              HTTP Response Entity will contain the signed error
              message, including the error code and the digest of the
              bytes recieved.
            
</dd>
<dt>500</dt>
<dd>
              Indicates an internal error while the recieving server
              was processing the request. The Sender MAY retry
              delivery.
            
</dd>
</dl></blockquote><p>
          Any response with a Status Code not listed above is
          considered a permanent failure to deliver.
        
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DTP-1">[DTP-1]</a></td>
<td class="author-text">Monroe, G., &ldquo;DTP Version 1.0 Part 1: Envelopes.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP">[HTTP]</a></td>
<td class="author-text">Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Grant Monroe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">JanRain, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5331 SW Macadam Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite #375</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Portland, OR  97239</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:grant@janrain.com">grant@janrain.com</a></td></tr>
</table>
</body></html>
